# File Structure

## Project Root Structure

```xml
<project-structure>
  <root>xalpheric-neocities/</root>
  
  <configuration-files>
    <file name="package.json" purpose="Node.js project configuration and npm scripts"/>
    <file name="README.md" purpose="Main project documentation"/>
    <file name=".env" purpose="Environment variables (API keys, not in repo)"/>
    <file name=".gitignore" purpose="Git exclusion patterns"/>
  </configuration-files>
  
  <build-scripts>
    <file name="build-musings.js" purpose="Markdown to HTML conversion engine"/>
    <file name="process-photos.js" purpose="Image processing and optimization"/>
    <file name="process-video.js" purpose="Video to audio conversion"/>
    <file name="check-deps.js" purpose="Dependency validation and installation"/>
  </build-scripts>
  
  <processing-workspaces>
    <directory name="process_photos/" purpose="Temporary workspace for image processing">
      <contents>Input images (HEIC, JPEG, PNG)</contents>
      <script>run_me.sh</script>
      <documentation>README.md</documentation>
    </directory>
    <directory name="process_video/" purpose="Temporary workspace for video processing">
      <contents>Input videos (MP4, MOV, M4V)</contents>
      <script>convert_videos.sh</script>
      <documentation>README.md</documentation>
    </directory>
  </processing-workspaces>
  
  <content-source>
    <directory name="thoughts-and-musings/" purpose="Source markdown files for blog/musings">
      <file-pattern>*.md</file-pattern>
      <processing>Converted to HTML by build-musings.js</processing>
    </directory>
  </content-source>
  
  <web-root>
    <directory name="public/" purpose="Built website files - deployment target">
      <!-- Detailed structure below -->
    </directory>
  </web-root>
  
  <cicd-infrastructure>
    <directory name=".github/" purpose="GitHub-specific files">
      <!-- Detailed structure below -->
    </directory>
  </cicd-infrastructure>
  
  <documentation>
    <file name="DEPENDENCIES.md" purpose="Dependency management documentation"/>
    <file name="PHOTO_PROCESSING.md" purpose="Photo processing guide"/>
    <file name="PHOTO_WATCHER.md" purpose="File watching system documentation"/>
  </documentation>
</project-structure>
```

## Public Directory Structure (Web Root)

```xml
<public-directory>
  <root>public/</root>
  
  <html-pages>
    <file name="index.html" purpose="Homepage with music releases"/>
    <file name="gallery.html" purpose="Photo gallery with lightbox"/>
    <file name="musings.html" purpose="Blog/musings listing page"/>
    <file name="links.html" purpose="External links and resources"/>
    <file name="guestbook.html" purpose="Visitor guestbook"/>
  </html-pages>
  
  <assets-directory>
    <directory name="assets/" purpose="Processed images and static assets">
      <image-types>Studio photos, release covers, logos, backgrounds</image-types>
      <formats>JPEG, PNG optimized for web</formats>
      <naming-patterns>studio{N}.jpg, saturn-oscillations{N}.jpg</naming-patterns>
      <source>Generated from process_photos/ workflow</source>
    </directory>
  </assets-directory>
  
  <audio-directory>
    <directory name="music/" purpose="Audio files for music player">
      <formats>MP3, WAV</formats>
      <source>Generated from process_video/ workflow or direct upload</source>
      <integration>Referenced by main.js audio player</integration>
    </directory>
  </audio-directory>
  
  <generated-content>
    <directory name="musings/" purpose="Generated HTML from markdown">
      <file name="index.html" purpose="Auto-generated index with navigation"/>
      <file-pattern>*.html" purpose="Individual musing pages"/>
      <source>Generated by build-musings.js from thoughts-and-musings/</source>
    </directory>
  </generated-content>
  
  <stylesheets>
    <directory name="css/" purpose="Cascading Style Sheets">
      <file name="theme.css" purpose="Main site theme with cyberpunk aesthetic">
        <features>Animations, responsive design, component styles</features>
        <size>~1349 lines</size>
        <includes>Gallery, lightbox, audio player, navigation styles</includes>
      </file>
    </directory>
  </stylesheets>
  
  <javascript>
    <directory name="js/" purpose="Client-side JavaScript">
      <file name="main.js" purpose="Homepage functionality and music player"/>
      <file name="gallery.js" purpose="Gallery management and lightbox system"/>
      <file name="audio-player.js" purpose="Custom audio player component"/>
      <file name="radio-player.js" purpose="Radio/streaming player functionality"/>
      <file name="notes.js" purpose="Note-taking or annotation features"/>
    </directory>
  </javascript>
</public-directory>
```

## GitHub Infrastructure

```xml
<github-directory>
  <root>.github/</root>
  
  <documentation>
    <file name="README.md" purpose="GitHub Actions and deployment setup guide"/>
  </documentation>
  
  <deployment-scripts>
    <directory name="scripts/" purpose="Build and deployment automation">
      <file name="deploy-musings.js" purpose="Incremental musings deployment">
        <features>Builds markdown, uploads to Neocities</features>
        <dependencies>form-data, markdown-it, dotenv</dependencies>
      </file>
      <file name="deploy-full-refresh.js" purpose="Complete site rebuild and upload">
        <features>SHA1 comparison, dry-run mode, selective file inclusion</features>
        <options>--dry-run, --include-mp3s, --include-assets</options>
      </file>
      <file name="deploy-assets.js" purpose="Asset-only deployment for GitHub Actions">
        <features>Change detection, batch upload, CI/CD integration</features>
      </file>
      <file name="deploy-recent-commit.js" purpose="Deploy changes from recent commits">
        <features>Git diff analysis, selective deployment</features>
      </file>
    </directory>
  </deployment-scripts>
  
  <workflows>
    <directory name="workflows/" purpose="GitHub Actions CI/CD workflows">
      <file-pattern>*.yml</file-pattern>
      <triggers>Push events, manual dispatch, schedule</triggers>
    </directory>
  </workflows>
</github-directory>
```

## Processing Workspaces Detail

### Photo Processing Workspace
```xml
<photo-workspace>
  <directory>process_photos/</directory>
  <purpose>Temporary staging area for image processing</purpose>
  
  <workflow>
    1. User places images (HEIC, JPEG, PNG) in directory
    2. Runs npm run process-photos with parameters
    3. ImageMagick processes and resizes images
    4. Processed images moved to public/assets/
    5. Original files cleaned up
  </workflow>
  
  <supported-formats>
    <input>HEIC (iPhone), JPEG, PNG, AVIF</input>
    <output>JPEG, PNG (web-optimized)</output>
  </supported-formats>
  
  <naming-options>
    <option>Keep original names</option>
    <option>Custom patterns: studio{increment}, photo{increment}</option>
    <option>Automatic numbering for sequences</option>
  </naming-options>
</photo-workspace>
```

### Video Processing Workspace
```xml
<video-workspace>
  <directory>process_video/</directory>
  <purpose>Temporary staging area for video-to-audio conversion</purpose>
  
  <workflow>
    1. User places video files (MP4, MOV, M4V) in directory
    2. Creates JSON configuration for input/output mapping
    3. Runs npm run process-video with JSON config
    4. FFmpeg extracts audio from videos
    5. Audio files moved to public/music/
    6. Original videos optionally cleaned up
  </workflow>
  
  <configuration>
    <format>JSON array of {inputName, outputName} objects</format>
    <example>[{"inputName":"video.mp4","outputName":"song.mp3"}]</example>
  </configuration>
  
  <supported-formats>
    <input>MP4, MOV, M4V, AVI</input>
    <output>MP3, WAV, AAC</output>
  </supported-formats>
</video-workspace>
```

## File Ownership and Responsibilities

### Build System Files
- `build-musings.js` - Owned by content management system
- `process-photos.js` - Owned by media processing system
- `process-video.js` - Owned by media processing system
- `check-deps.js` - Owned by dependency management system

### Generated Files (Auto-managed)
- `public/musings/*.html` - Generated by build-musings.js
- `public/musings/index.html` - Auto-generated navigation index
- `public/assets/*` - Generated by photo processing
- `public/music/*` - Generated by video processing

### User-Managed Files
- `thoughts-and-musings/*.md` - User creates and edits
- `public/*.html` - User designs and maintains
- `public/css/theme.css` - User customizes styling
- `public/js/*.js` - User develops functionality

### Configuration Files
- `package.json` - Project metadata and scripts
- `.env` - Environment variables (not in repo)
- Gallery configuration in `public/js/gallery.js`

## File Size and Performance Considerations

### Large Files (Excluded by Default)
- `public/music/*.mp3` - Can be excluded from deployments
- `public/assets/` - Large images can be excluded
- Processing workspace files - Temporary, cleaned up

### Small Files (Always Included)
- HTML pages (~1-50KB each)
- CSS files (~50-100KB)
- JavaScript files (~5-20KB each)
- Markdown source files (~1-10KB each)

### Generated File Patterns
- Musings: `{sanitized-title}.html`
- Photos: `{pattern}{increment}.{ext}` or original names
- Audio: User-defined in JSON configuration

---

*This file structure serves as the foundation for understanding code organization and file relationships throughout the system.*
